#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
修复Windows编码问题：替换bat文件中的emoji字符
"""

import os
import re

def fix_bat_file_encoding(filename):
    """修复单个bat文件的编码问题"""
    if not os.path.exists(filename):
        print(f"❌ 文件不存在: {filename}")
        return False
    
    # 定义emoji替换映射
    emoji_replacements = {
        '🔧': '[配置]',
        '🔍': '[检测]', 
        '📦': '[安装]',
        '🎯': '[启动]',
        '💡': '[提示]',
        '⚡': '[执行]',
        '🎉': '[完成]',
        '📥': '[下载]',
        '✅': '[OK]',
        '❌': '[ERROR]',
        '⚠️': '[WARN]',
        '🚀': '[运行]',
        '📋': '[步骤]',
        '🏢': '[金潮男装]',
        '📱': '[手机]',
        '🌐': '[网络]',
        '🛡️': '[安全]',
        '📖': '[文档]',
        '📞': '[支持]',
        '📄': '[文件]',
        '🔄': '[重试]',
        '🤔': '[选择]',
        '⏳': '[等待]',
        '📺': '[显示]',
        '🔗': '[链接]',
        '💻': '[电脑]',
        '🔑': '[密钥]',
        '📊': '[数据]',
        '🎨': '[界面]',
        '🔒': '[安全]',
        '🧪': '[测试]',
        '📝': '[记录]',
        '🔥': '[热门]',
        '♻️': '[循环]',
        '📤': '[导出]',
        '📥': '[导入]',
        '🎪': '[演示]',
        '🏆': '[成功]',
        '🔨': '[工具]',
        '📈': '[统计]',
        '🎮': '[游戏]',
        '🎵': '[音乐]',
        '🎬': '[视频]',
        '🎭': '[表演]',
        '🎪': '[马戏]',
        '🎨': '[艺术]',
        '🎯': '[目标]',
        '🎲': '[随机]',
        '🎳': '[保龄]',
        '🎸': '[吉他]',
        '🎹': '[钢琴]',
        '🎺': '[号角]',
        '🎻': '[小提琴]',
        '🥁': '[鼓]',
        '🎤': '[麦克风]',
        '🎧': '[耳机]',
        '🎬': '[电影]',
        '📹': '[录像]',
        '📷': '[相机]',
        '📸': '[拍照]',
        '💾': '[保存]',
        '💿': '[光盘]',
        '📀': '[DVD]',
        '💻': '[笔记本]',
        '🖥️': '[桌面]',
        '🖨️': '[打印]',
        '⌨️': '[键盘]',
        '🖱️': '[鼠标]',
        '🖲️': '[轨迹球]',
        '💽': '[磁盘]',
        '💾': '[软盘]',
        '💿': '[CD]',
        '📀': '[DVD]',
        '🧮': '[算盘]',
        '🎞️': '[胶片]',
        '📽️': '[投影]',
        '🎥': '[摄像]',
        '📺': '[电视]',
        '📻': '[收音机]',
        '🎙️': '[录音]',
        '🎚️': '[调音]',
        '🎛️': '[控制]',
        '🧭': '[指南针]',
        '⏱️': '[秒表]',
        '⏲️': '[定时]',
        '⏰': '[闹钟]',
        '🕰️': '[时钟]',
        '⌛': '[沙漏]',
        '⏳': '[等待]',
        '📡': '[卫星]',
        '🔋': '[电池]',
        '🔌': '[插头]',
        '💡': '[灯泡]',
        '🔦': '[手电]',
        '🕯️': '[蜡烛]',
        '🪔': '[油灯]',
        '🧯': '[灭火器]',
        '🛢️': '[油桶]',
        '💸': '[飞钱]',
        '💵': '[美元]',
        '💴': '[日元]',
        '💶': '[欧元]',
        '💷': '[英镑]',
        '💰': '[钱袋]',
        '💳': '[信用卡]',
        '💎': '[钻石]',
        '⚖️': '[天平]',
        '🧰': '[工具箱]',
        '🔧': '[扳手]',
        '🔨': '[锤子]',
        '⚒️': '[铁锤]',
        '🛠️': '[工具]',
        '⛏️': '[镐]',
        '🔩': '[螺丝]',
        '⚙️': '[齿轮]',
        '🧱': '[砖头]',
        '⛓️': '[链条]',
        '🧲': '[磁铁]',
        '🔫': '[水枪]',
        '💣': '[炸弹]',
        '🧨': '[爆竹]',
        '🪓': '[斧头]',
        '🔪': '[刀]',
        '🗡️': '[剑]',
        '⚔️': '[交叉剑]',
        '🛡️': '[盾牌]',
        '🚬': '[香烟]',
        '⚰️': '[棺材]',
        '🪦': '[墓碑]',
        '⚱️': '[骨灰盒]',
        '🏺': '[陶罐]',
        '🔮': '[水晶球]',
        '📿': '[念珠]',
        '🧿': '[恶魔眼]',
        '💈': '[理发]',
        '⚗️': '[蒸馏器]',
        '🔭': '[望远镜]',
        '🔬': '[显微镜]',
        '🕳️': '[洞]',
        '🩹': '[创可贴]',
        '🩺': '[听诊器]',
        '💊': '[药丸]',
        '💉': '[注射器]',
        '🩸': '[血滴]',
        '🧬': '[DNA]',
        '🦠': '[病毒]',
        '🧫': '[培养皿]',
        '🧪': '[试管]',
        '🌡️': '[温度计]',
        '🧹': '[扫帚]',
        '🧺': '[篮子]',
        '🧻': '[卷纸]',
        '🚽': '[马桶]',
        '🚿': '[淋浴]',
        '🛁': '[浴缸]',
        '🛀': '[洗澡]',
        '🧴': '[洗护用品]',
        '🧷': '[安全别针]',
        '🧸': '[泰迪熊]',
        '🧵': '[线]',
        '🧶': '[毛线]',
        '👓': '[眼镜]',
        '🕶️': '[墨镜]',
        '🥽': '[护目镜]',
        '🥼': '[实验服]',
        '🦺': '[安全背心]',
        '👔': '[领带]',
        '👕': '[T恤]',
        '👖': '[裤子]',
        '🧣': '[围巾]',
        '🧤': '[手套]',
        '🧥': '[外套]',
        '🧦': '[袜子]',
        '👗': '[连衣裙]',
        '👘': '[和服]',
        '🥻': '[纱丽]',
        '🩱': '[比基尼]',
        '🩲': '[内裤]',
        '🩳': '[短裤]',
        '👙': '[比基尼]',
        '👚': '[女式衬衫]',
        '👛': '[钱包]',
        '👜': '[手提包]',
        '👝': '[离合器]',
        '🛍️': '[购物袋]',
        '🎒': '[背包]',
        '👞': '[男鞋]',
        '👟': '[运动鞋]',
        '🥾': '[靴子]',
        '🥿': '[平底鞋]',
        '👠': '[高跟鞋]',
        '👡': '[凉鞋]',
        '🩴': '[人字拖]',
        '👢': '[女靴]',
        '👑': '[皇冠]',
        '👒': '[女帽]',
        '🎩': '[礼帽]',
        '🎓': '[学士帽]',
        '🧢': '[棒球帽]',
        '⛑️': '[安全帽]',
        '📿': '[念珠]',
        '💄': '[口红]',
        '💍': '[戒指]',
        '💎': '[钻石]'
    }
    
    try:
        # 读取文件
        with open(filename, 'r', encoding='utf-8') as f:
            content = f.read()
        
        original_content = content
        
        # 替换emoji字符
        for emoji, replacement in emoji_replacements.items():
            content = content.replace(emoji, replacement)
        
        # 写回文件
        if content != original_content:
            with open(filename, 'w', encoding='utf-8') as f:
                f.write(content)
            print(f"✅ 已修复: {filename}")
            return True
        else:
            print(f"ℹ️  无需修复: {filename}")
            return True
            
    except Exception as e:
        print(f"❌ 修复失败 {filename}: {e}")
        return False

def main():
    """主函数"""
    print("=" * 50)
    print("🔧 修复Windows编码问题")
    print("   替换bat文件中的emoji字符")
    print("   金潮男装供应链")
    print("=" * 50)
    
    bat_files = [
        'install_windows.bat',
        'start_windows.bat'
    ]
    
    success_count = 0
    for filename in bat_files:
        if fix_bat_file_encoding(filename):
            success_count += 1
    
    print("\n" + "=" * 50)
    print(f"📊 修复结果: {success_count}/{len(bat_files)} 个文件")
    
    if success_count == len(bat_files):
        print("🎉 所有bat文件编码修复完成！")
        print("现在可以在Windows上正常运行了")
    else:
        print("⚠️ 部分文件修复失败")
    
    print("=" * 50)

if __name__ == "__main__":
    main() 